const moment = require("moment-timezone");

module.exports.config = {
  name: "autotimer",
  version: "3.3",
  role: 0,
  author: "MOHAMMAD AKASH",
  description: "â° à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦£à§à¦Ÿà¦¾à§Ÿ à¦¸à¦¬ à¦—à§à¦°à§à¦ªà§‡ à¦¹à§‡à¦¡à¦¾à¦°à¦¸à¦¹ à¦…à¦Ÿà§‹ à¦®à§‡à¦¸à§‡à¦œ à¦ªà¦¾à¦ à¦¾à¦¬à§‡ (24-hour system)",
  category: "system",
  countDown: 3,
};

module.exports.onLoad = async function ({ api }) {

  // â³ à¦¬à¦Ÿ à¦²à§‹à¦¡ à¦¹à¦¤à§‡ à§« à¦¸à§‡à¦•à§‡à¦¨à§à¦¡ à¦…à¦ªà§‡à¦•à§à¦·à¦¾ à¦•à¦°à¦¬à§‡
  setTimeout(async () => {

    const timerData = {
      "12:00:00 AM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 12:00 ð—”ðŒ â³ ð’ð¨ ð‰ðšð¨ ððšð›ð² ð†ð¨ð¨ð ðð¢ð ð¡ð­ ðŸ¥€ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "01:00:00 AM": "ðŸŒŒ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 1:00 AðŒ â³ ð—§ð˜‚ð—ºð—µð—®ð—¿ð—® ðŒð—²ð—¿ð—² ð’ð—¶ð˜ƒð—®ðŸ˜˜ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "02:00:00 AM": "ðŸŒ  â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 2:00 AðŒ â³ ð—§ð˜‚ð—º ð—”ð—¯ð—µð—¶ ð—§ð—®ð—¸ ð—¦ð—¼ð˜†ð—² ð—¡ð—µð—¶ ðŸ˜³ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "03:00:00 AM": "ðŸŒƒ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 3:00 AðŒ â³ ð€ðœðœð¡ðš ð¡ð¨ð ðš ððžðžð§ð ð€ðšð£ðšð²ðžðŸŒƒ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "04:00:00 AM": "ðŸŒ„ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 4:00 AðŒ â³ ððžðžð§ð ð€ðšð£ðšð²ðž ðŸŒƒ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "05:00:00 AM": "ðŸŒ… â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 5:00 ð—”ðŒ â³ ð€ðšð¥ð¬ð¢ðŸ˜¹ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€â˜€ï¸",
      "06:00:00 AM": "â—‹   'ð“†©âƒðŸ™ðŸ½ ð“†©âƒð—”ð—¦ð—Ÿð—Ÿð—”ð— ð—¨ð—”ð—Ÿð—œð—žð—¨ð—  ð“†©âƒðŸ™ðŸ½ â¤ï¸â¥----------â¥[x] â–ˆ#â¤ï¸#â–ˆ[x] â¥----------â¥â¤ï¸     â”Š          â”Š           â”Š ðŸ  ð“†©âƒð—šð—¢ð—¢ð——     ðŸ ð“†ªâƒ     ð— ð—¢ð—¥ð—¡ð—œð—¡ð—šð“†©â˜•",
      "07:00:00 AM": "ðŸž â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 7:00 AðŒ â³ ð”ð­ð¡ ð‰ðšð¨ ð€ð›ð¡ð¢ðŸ¥° â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "08:00:00 AM": "ðŸŒ¤ï¸  â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 8:00 AðŒ â³ ð”ð­ð¡ ð†ð²ðž ðð«ðžð¬ð¢ððžð§ð­ ð£ðˆ ð€ðšð©?ðŸ˜µ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "09:00:00 AM": "ðŸ•˜ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 9:00 AðŒ â³ ðð«ðžðšð¤ðŸðšð¬ð­ ðŠðšð«ð¥ð¨ ð€ð›ð¡ð¢ ððšð›ð²ðŸ™ˆ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "10:00:00 AM": " â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 10:00 AðŒ â³ ð€ðšð¥ð¬ð¢ ð€ðšð£ ð‚ð¨ð¥ð¥ðžð ðž ððšð¡ð¢ ð†ðšð²ðž?ðŸ™€ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "11:00:00 AM": "ðŸŒ» â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 11:00 AðŒ â³ ðŒð®ð£ð¡ðž ðð¡ð¢ ð˜ðšðšð ðŠðšð« ð‹ð¢ð²ðš ðŠðšð«ð¨ðŸ˜» â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðŸ˜Œ",
      "12:00:00 PM": " â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 12:00 ððŒ â³ ð†ð¨ð¨ð ð€ðŸð­ðžð«ðð¨ð¨ð§ ð„ð¯ðžð«ð²ð¨ð§ðžðŸŒž ðŠð¢ð­ð§ð¢ ð†ðšð«ð¦ð¢ ð‡ ððšð¡ðšð«ðŸ¥µ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "01:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 1:00 ððŒ â³ ð‹ð®ð§ðœð¡ ðŠðšð«ð¥ð¨ ð€ð›ð¡ð¢ðŸ˜‡ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "02:00:00 PM": " â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 2:00 ððŒ â³ ð€ð¥ð¥ðšð¡ ð¤ðš ð’ð®ð¤ðšð« ð¡ðž ðŒðšð³ðž ðŒðž ð‡ð® ðŸ’–ðŸ˜‡ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "03:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 3:00 ððŒ â³ ð“ð¡ð¨ððš ð€ðšð«ðšð¦ ðŠðšð«ð¥ð¨ ð€ð›ð¡ð¢ðŸ˜˜ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "04:00:00 PM": "ðŸŒ‡ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 4:00 ððŒ â³ ððšð¡ð®ð­ ð†ðšð«ð¦ð¢ ð‡ ð€ðšð£ðŸ¥µ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ",
      "05:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 5:00 ððŒ â³ ð‡ðšð« ð‡ðšð¥ ðŒðž ð‡ðšð¦ðžð¬ð¡ðš ðŠð¡ð®ð¬ð¡ ð‘ðšð¡ð¨ ðŸ˜‡ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "06:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 6:00 ððŒ â³ ð€ð¬ð¬ðšð¥ðšð¦ð® ð–ðšð¥ðžð¢ð¤ð®ð¦ ð¨ð« ð›ðšð­ðšð¨ ð¤ðšð¢ð¬ðž ð¡ð¨ ðŸ’– â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "07:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 7:00 ððŒ â³ ðŠð¡ð®ð¬ð¡ ð‘ðšð¡ð§ðš ðŒðžð«ðš ðð«ð¨ð¦ð¢ð¬ðž ðŸ’ž â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "08:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 8:00 ððŒ â³ ðƒð¢ð§ð§ðžð« ðŠðšð«ð¥ð¨ ð’ðšð«ðž ðŸ˜‹ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "09:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 9:00 ððŒ â³ ðŒðžð«ðž ð‚ð®ð­ðž ððšð›ð² ðŸ’ž â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "10:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 10:00 ððŒ â³ ð“ð®ð¦ ðŒð®ð¬ð¤ð®ð«ðšð¨ ð‡ðšð¬ð¨ ð‡ðšð¦ðžð¬ð¡ðš â˜ºï¸ â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€",
      "11:00:00 PM": "â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€ ðð¨ð° ð¢ð­ð¬ ð­ð¢ð¦ðž 11:00 ððŒ â³ ðð›ð² ðŠð¡ðšð§ðš ðŠð¡ðšð²ðš ð€ðšð©ððž? â”€â”€â”€â”€ â€¢ðŸ’œâ€¢ â”€â”€â”€â”€"
    };
    console.log("âœ… AutoTimer System Loaded â€” à¦ªà§à¦°à¦¤à¦¿ à¦˜à¦£à§à¦Ÿà¦¾à§Ÿ à¦¸à¦®à§Ÿ à¦šà§‡à¦• à¦¶à§à¦°à§ à¦¹à§Ÿà§‡à¦›à§‡...");

    const checkTimeAndSend = async () => {
      const now = moment().tz("Asia/Kolkata").format("hh:mm:ss A");
      const messageText = timerData[now];

      if (messageText) {
        const timeFormatted = moment().tz("Asia/Kolkata").format("hh:mm A");
        const todayDate = moment().tz("Asia/Kolkata").format("DD-MM-YYYY");
        const hour = parseInt(moment().tz("Asia/Kolkata").format("HH"));
        let period = "";

        if (hour >= 4 && hour < 12) period = "à¦¸à¦•à¦¾à¦²";
        else if (hour >= 12 && hour < 17) period = "à¦¦à§à¦ªà§à¦°";
        else if (hour >= 17 && hour < 20) period = "à¦¬à¦¿à¦•à§‡à¦²";
        else if (hour >= 20 && hour < 24) period = "à¦°à¦¾à¦¤";
        else period = "à¦­à§‹à¦°";

        const finalMessage =
`â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ•’ : ${period} ${timeFormatted}  
${messageText}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“… DATE : ${todayDate}
ðŸ¤– BOT OWNER : SULTAN JI
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”`;

        try {
          const allThreads = await api.getThreadList(100, null, ["INBOX"]);
          const groupThreads = allThreads.filter(t => t.isGroup);

          console.log(`ðŸ•’ ${now} â†’ ${groupThreads.length} ...`);

          for (const thread of groupThreads) {
            await api.sendMessage(finalMessage, thread.threadID);
          }

          console.log("âœ… à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦¸à¦¬ à¦—à§à¦°à§à¦ªà§‡ à¦¬à¦¾à¦°à§à¦¤à¦¾ à¦ªà¦¾à¦ à¦¾à¦¨à§‹ à¦¹à§Ÿà§‡à¦›à§‡!");
        } catch (err) {
          console.error("âŒ AutoTimer Error:", err);
        }
      }
    };

    setInterval(checkTimeAndSend, 1000);
  }, 5000);
};

module.exports.onStart = () => {};
